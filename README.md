
import telebot
from telebot import types
import logging
from keep_alive import keep_alive  # ุงุณุชูุฑุงุฏ ุฏุงูุฉ keep_alive

# ุฅุนุฏุงุฏ ุชุณุฌูู ุงูุฃุฎุทุงุก
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# ุฅุนุฏุงุฏ ุงูุชููู ุงูุฎุงุต ุจุงูุจูุช (ุงุณุชุจุฏูู ุจุงูุชููู ุงูุฎุงุต ุจู)
TOKEN = "7884758906:AAHjXUAkcYWU_TGDowsaRqYsEssJGxdFdh4"

bot = telebot.TeleBot(TOKEN)

# ูุงุฆูุฉ ุงูุฃุณุฆูุฉ ูุงูุฅุฌุงุจุงุช ุงูุตุญูุญุฉ
QUESTIONS = [7
    {
        "question": "ูุชู ูุฑุถ ุงูุตูุงู ุนูู ุงููุณููููุ",
        "options": ["ูู ุงูุณูุฉ ุงูุฃููู ูููุฌุฑุฉ", "ูู ุงูุณูุฉ ุงูุซุงููุฉ ูููุฌุฑุฉ", "ูู ุงูุณูุฉ ุงูุซุงูุซุฉ ูููุฌุฑุฉ", "ูู ุงูุณูุฉ ุงูุฑุงุจุนุฉ ูููุฌุฑุฉ"],
        "answer": "ูู ุงูุณูุฉ ุงูุซุงููุฉ ูููุฌุฑุฉ"
    },
    {
        "question": "ูุง ูู ุงูุดูุฑ ุงูุฐู ูุฃุชู ุจุนุฏ ุฑูุถุงู ูุจุงุดุฑุฉุ",
        "options": ["ุฑุฌุจ", "ุฐู ุงููุนุฏุฉ", "ุดูุงู", "ูุญุฑู"],
        "answer": "ุดูุงู"
    },
    {
        "question": "ุฃู ูู ุงูุฃููุฑ ุงูุชุงููุฉ ุชูุทุฑ ุงูุตุงุฆูุ",
        "options": ["ุงูุญุฌุงูุฉ", "ุงูุณูุงู", "ุดุฑุจ ุงููุงุก ุนูุฏูุง", "ูุถุน ุงูุนุทุฑ"],
        "answer": "ุดุฑุจ ุงููุงุก ุนูุฏูุง"
    },
    {
        "question": "ูู ุฃู ูููุฉ ูููู ุชุญุฑู ูููุฉ ุงููุฏุฑ ุบุงูุจูุงุ",
        "options": ["ูููุฉ 25", "ูููุฉ 27", "ูููุฉ 20", "ูููุฉ 15"],
        "answer": "ูููุฉ 27"
    },
    {
        "question": "ูุง ูู ุฃูู ุดูุก ููุถู ุฃู ููุทุฑ ุนููู ุงูุตุงุฆูุ",
        "options": ["ูุงุก", "ุฎุจุฒ", "ุชูุฑ", "ููุงูู"],
        "answer": "ุชูุฑ"
    },
    {
        "question": "ุฃู ูู ูุฐู ุงูุนุจุงุฏุงุช ููุซุฑ ุงููุณูููู ูู ุฃุฏุงุฆูุง ูู ุฑูุถุงูุ",
        "options": ["ุงูุญุฌ", "ุงูุฒูุงุฉ", "ุตูุงุฉ ุงูุชุฑุงููุญ", "ุงูุฃุถุญูุฉ"],
        "answer": "ุตูุงุฉ ุงูุชุฑุงููุญ"
    },
    {
        "question": "ูู ุนุฏุฏ ุงูุฑูุนุงุช ูู ุตูุงุฉ ุงูุชุฑุงููุญ ุบุงูุจูุงุ",
        "options": ["4", "6", "8", "12"],
        "answer": "8"
    },
    {
        "question": "ุฃู ูู ูุฐู ุงููุฆุงุช ูุง ูุฌุจ ุนูููุง ุงูุตูุงูุ",
        "options": ["ุงูุทูู ุงูุตุบูุฑ", "ุงููููุฑ", "ุงููุณุงูุฑ", "ุงูุดุงุจ ุงููุงุฏุฑ"],
        "answer": "ุงูุทูู ุงูุตุบูุฑ"
    },
    {
        "question": "ูุชู ูููู ููุช ุงูุณุญูุฑุ",
        "options": ["ุจุนุฏ ุงููุฌุฑ", "ูุจู ุงููุฌุฑ", "ุจุนุฏ ุงููุบุฑุจ", "ููุชุตู ุงูููู"],
        "answer": "ูุจู ุงููุฌุฑ"
    },
    {
        "question": "ุฃู ูู ุงูุนุจุงุฑุงุช ุงูุชุงููุฉ ุตุญูุญุฉ ุนู ุงูุตูุงูุ",
        "options": ["ูุฌูุฒ ุงูุฅูุทุงุฑ ูุฃู ุดุฎุต ุฏูู ุนุฐุฑ", "ูุง ูุฌูุฒ ุงูุตูุงู ุฅูุง ูููุณูููู", "ูุฌูุฒ ุดุฑุจ ุงููุงุก ุฃุซูุงุก ุงูุตูุงู", "ูุฌุจ ุงูุตูุงู ุญุชู ุจุนุฏ ุบุฑูุจ ุงูุดูุณ"],
        "answer": "ูุง ูุฌูุฒ ุงูุตูุงู ุฅูุง ูููุณูููู"
    },
    {
        "question": "ูุชู ูููู ููุนุฏ ุงูุฅูุทุงุฑุ",
        "options": ["ุนูุฏ ุฃุฐุงู ุงููุฌุฑ", "ุนูุฏ ุฃุฐุงู ุงูุธูุฑ", "ุนูุฏ ุฃุฐุงู ุงููุบุฑุจ", "ุนูุฏ ููุชุตู ุงูููู"],
        "answer": "ุนูุฏ ุฃุฐุงู ุงููุบุฑุจ"
    },
    {
        "question": "ูุง ูู ุญูู ุตูุงู ุฑูุถุงูุ",
        "options": ["ูุณุชุญุจ", "ูุงุฌุจ", "ููุฑูู", "ูุจุงุญ"],
        "answer": "ูุงุฌุจ"
    },
    {
        "question": "ูุงุฐุง ูุญุฏุซ ุฅุฐุง ุฃูู ุงูุตุงุฆู ุฃู ุดุฑุจ ูุงุณููุงุ",
        "options": ["ูุจุทู ุตูุงูู", "ูุฌุจ ุนููู ุงููุถุงุก", "ุตูุงูู ุตุญูุญ", "ุนููู ููุงุฑุฉ"],
        "answer": "ุตูุงูู ุตุญูุญ"
    },
    {
        "question": "ูุง ูู ุงูุฏุนุงุก ุงูุฐู ูููุงู ุนูุฏ ุงูุฅูุทุงุฑุ",
        "options": ["ุงูููู ุฅูู ุฃุณุฃูู ุงูุนูู ูุงูุนุงููุฉ", "ุงูููู ุจุงุฑู ููุง ูู ูุฐุง ุงูุทุนุงู", "ุงูููู ูู ุตูุช ูุนูู ุฑุฒูู ุฃูุทุฑุช", "ูุง ุฅูู ุฅูุง ุงููู ูุญุฏู ูุง ุดุฑูู ูู"],
        "answer": "ุงูููู ูู ุตูุช ูุนูู ุฑุฒูู ุฃูุทุฑุช"
    },
    {
        "question": "ูุง ุงุณู ุงูุจุงุจ ุงูุฐู ูุฏุฎู ููู ุงูุตุงุฆููู ุฅูู ุงูุฌูุฉุ",
        "options": ["ุจุงุจ ุงูุฌูุฉ", "ุจุงุจ ุงูุฑูุงู", "ุจุงุจ ุงููุฑุฏูุณ", "ุจุงุจ ุงูุฑุญูุฉ"],
        "answer": "ุจุงุจ ุงูุฑูุงู"
    },
    {
        "question": "ูู ูููุงู ูุฌุจ ุฃู ูุตูู ุงููุณูู ูู ุฑูุถุงูุ",
        "options": ["25 ููููุง", "30 ููููุง", "28 ููููุง", "27 ููููุง"],
        "answer": "30 ููููุง"
    },
    {
        "question": "ูุชู ูุจุฏุฃ ุดูุฑ ุฑูุถุงูุ",
        "options": ["ุนูุฏ ุฑุคูุฉ ุงูููุงู", "ููู 1 ุฃุจุฑูู", "ุนูุฏ ุงูุชูุงู ุงูููุฑ", "ุจุนุฏ ุดูุฑ ุฑุฌุจ"],
        "answer": "ุนูุฏ ุฑุคูุฉ ุงูููุงู"
    },
    {
        "question": "ุฃู ูู ูุฐู ุงููุฆุงุช ูุฌูุฒ ููุง ุงูุฅูุทุงุฑ ูู ุฑูุถุงูุ",
        "options": ["ุงููุฑูุถ", "ุงููููุฑ", "ุงูุดุงุจ ุงูููู", "ุงูุฃุทูุงู"],
        "answer": "ุงููุฑูุถ"
    },
    {
        "question": "ูุชู ูุฒู ุงููุฑุขู ุนูู ุงููุจู ๏ทบ ูุฃูู ูุฑุฉุ",
        "options": ["ูููุฉ ุงููุตู ูู ุดุนุจุงู", "ูููุฉ ุงููุฏุฑ", "ุฃูู ูุญุฑู", "ูููุฉ ุงูุฅุณุฑุงุก ูุงููุนุฑุงุฌ"],
        "answer": "ูููุฉ ุงููุฏุฑ"
    },
    {
        "question": "ุฃู ุณูุฑุฉ ูู ุงููุฑุขู ุชุชุญุฏุซ ุนู ูุฑุถูุฉ ุงูุตูุงูุ",
        "options": ["ุงููุงุชุญุฉ", "ุงูุจูุฑุฉ", "ุงููุงุฆุฏุฉ", "ุงููุณุงุก"],
        "answer": "ุงูุจูุฑุฉ"
    },
    {
        "question": "ูู ูุงู ุนูุฑ ุงููุจู ๏ทบ ุนูุฏูุง ูุฑุถ ุงูุตูุงูุ",
        "options": ["35 ุณูุฉ", "40 ุณูุฉ", "45 ุณูุฉ", "53 ุณูุฉ"],
        "answer": "53 ุณูุฉ"
    },
    {
        "question": "ูุง ูู ุนุฏุฏ ุงูุขูุงุช ุงูุชู ุชุชุญุฏุซ ุนู ุงูุตูุงู ูู ุณูุฑุฉ ุงูุจูุฑุฉุ",
        "options": ["3", "5", "7", "9"],
        "answer": "5"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุฏูู ุนุฐุฑุ",
        "options": ["ูุฌุจ ุนููู ุงููุถุงุก ููุท", "ูุฌุจ ุนููู ุงููุถุงุก ูุงูููุงุฑุฉ", "ูุง ุดูุก ุนููู", "ูุฌุจ ุนููู ุงูููุงุฑุฉ ููุท"],
        "answer": "ูุฌุจ ุนููู ุงููุถุงุก ูุงูููุงุฑุฉ"
    },
    {
        "question": "ูุง ูู ุงูููุงุฑุฉ ุงููุชุฑุชุจุฉ ุนูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุฏูู ุนุฐุฑุ",
        "options": ["ุฅุทุนุงู 10 ูุณุงููู", "ุตูุงู ุดูุฑูู ูุชุชุงุจุนูู", "ุชุญุฑูุฑ ุฑูุจุฉ", "ุตูุงู 60 ููููุง"],
        "answer": "ุตูุงู ุดูุฑูู ูุชุชุงุจุนูู"
    },
    {
        "question": "ูุง ูู ุญูู ูู ูุงู ุทูุงู ููุงุฑ ุฑูุถุงูุ",
        "options": ["ุตูุงูู ุตุญูุญ", "ุตูุงูู ุจุงุทู", "ูุฌุจ ุนููู ุงููุถุงุก", "ุนููู ููุงุฑุฉ"],
        "answer": "ุตูุงูู ุตุญูุญ"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูู ุฃู ุดุฑุจ ูุงุณููุง ูู ููุงุฑ ุฑูุถุงูุ",
        "options": ["ุตูุงูู ุตุญูุญ", "ุตูุงูู ุจุงุทู", "ูุฌุจ ุนููู ุงููุถุงุก", "ุนููู ููุงุฑุฉ"],
        "answer": "ุตูุงูู ุตุญูุญ"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุณุจุจ ุงููุฑุถุ",
        "options": ["ูุฌุจ ุนููู ุงููุถุงุก ููุท", "ูุฌุจ ุนููู ุงููุถุงุก ูุงูููุงุฑุฉ", "ูุง ุดูุก ุนููู", "ูุฌุจ ุนููู ุงูููุงุฑุฉ ููุท"],
        "answer": "ูุฌุจ ุนููู ุงููุถุงุก ููุท"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุณุจุจ ุงูุณูุฑุ",
        "options": ["ูุฌุจ ุนููู ุงููุถุงุก ููุท", "ูุฌุจ ุนููู ุงููุถุงุก ูุงูููุงุฑุฉ", "ูุง ุดูุก ุนููู", "ูุฌุจ ุนููู ุงูููุงุฑุฉ ููุท"],
        "answer": "ูุฌุจ ุนููู ุงููุถุงุก ููุท"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุณุจุจ ุงูุญูู ุฃู ุงูุฑุถุงุนุฉุ",
        "options": ["ูุฌุจ ุนูููุง ุงููุถุงุก ููุท", "ูุฌุจ ุนูููุง ุงููุถุงุก ูุงูููุงุฑุฉ", "ูุง ุดูุก ุนูููุง", "ูุฌุจ ุนูููุง ุงูููุงุฑุฉ ููุท"],
        "answer": "ูุฌุจ ุนูููุง ุงููุถุงุก ููุท"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุณุจุจ ุงูุดูุฎูุฎุฉุ",
        "options": ["ูุฌุจ ุนููู ุงููุถุงุก ููุท", "ูุฌุจ ุนููู ุงููุถุงุก ูุงูููุงุฑุฉ", "ูุง ุดูุก ุนููู", "ูุฌุจ ุนููู ุงูููุงุฑุฉ ููุท"],
        "answer": "ูุง ุดูุก ุนููู"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุณุจุจ ุงูุฌูุน ุงูุดุฏูุฏุ",
        "options": ["ูุฌุจ ุนููู ุงููุถุงุก ููุท", "ูุฌุจ ุนููู ุงููุถุงุก ูุงูููุงุฑุฉ", "ูุง ุดูุก ุนููู", "ูุฌุจ ุนููู ุงูููุงุฑุฉ ููุท"],
        "answer": "ูุฌุจ ุนููู ุงููุถุงุก ููุท"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุณุจุจ ุงูุนุทุด ุงูุดุฏูุฏุ",
        "options": ["ูุฌุจ ุนููู ุงููุถุงุก ููุท", "ูุฌุจ ุนููู ุงููุถุงุก ูุงูููุงุฑุฉ", "ูุง ุดูุก ุนููู", "ูุฌุจ ุนููู ุงูููุงุฑุฉ ููุท"],
        "answer": "ูุฌุจ ุนููู ุงููุถุงุก ููุท"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุณุจุจ ุงูุฅูุฑุงูุ",
        "options": ["ูุฌุจ ุนููู ุงููุถุงุก ููุท", "ูุฌุจ ุนููู ุงููุถุงุก ูุงูููุงุฑุฉ", "ูุง ุดูุก ุนููู", "ูุฌุจ ุนููู ุงูููุงุฑุฉ ููุท"],
        "answer": "ูุง ุดูุก ุนููู"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุณุจุจ ุงููุณูุงูุ",
        "options": ["ุตูุงูู ุตุญูุญ", "ุตูุงูู ุจุงุทู", "ูุฌุจ ุนููู ุงููุถุงุก", "ุนููู ููุงุฑุฉ"],
        "answer": "ุตูุงูู ุตุญูุญ"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุณุจุจ ุงูุฎุทุฃุ",
        "options": ["ุตูุงูู ุตุญูุญ", "ุตูุงูู ุจุงุทู", "ูุฌุจ ุนููู ุงููุถุงุก", "ุนููู ููุงุฑุฉ"],
        "answer": "ุตูุงูู ุตุญูุญ"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุณุจุจ ุงูุฌููุ",
        "options": ["ุตูุงูู ุตุญูุญ", "ุตูุงูู ุจุงุทู", "ูุฌุจ ุนููู ุงููุถุงุก", "ุนููู ููุงุฑุฉ"],
        "answer": "ุตูุงูู ุตุญูุญ"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุณุจุจ ุงูุฅุบูุงุกุ",
        "options": ["ุตูุงูู ุตุญูุญ", "ุตูุงูู ุจุงุทู", "ูุฌุจ ุนููู ุงููุถุงุก", "ุนููู ููุงุฑุฉ"],
        "answer": "ุตูุงูู ุจุงุทู"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุณุจุจ ุงูุฌูููุ",
        "options": ["ุตูุงูู ุตุญูุญ", "ุตูุงูู ุจุงุทู", "ูุฌุจ ุนููู ุงููุถุงุก", "ุนููู ููุงุฑุฉ"],
        "answer": "ุตูุงูู ุจุงุทู"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุณุจุจ ุงูุญูุถุ",
        "options": ["ุตูุงููุง ุตุญูุญ", "ุตูุงููุง ุจุงุทู", "ูุฌุจ ุนูููุง ุงููุถุงุก", "ุนูููุง ููุงุฑุฉ"],
        "answer": "ุตูุงููุง ุจุงุทู"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุณุจุจ ุงูููุงุณุ",
        "options": ["ุตูุงููุง ุตุญูุญ", "ุตูุงููุง ุจุงุทู", "ูุฌุจ ุนูููุง ุงููุถุงุก", "ุนูููุง ููุงุฑุฉ"],
        "answer": "ุตูุงููุง ุจุงุทู"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุณุจุจ ุงูุฅุบูุงุก ุงูุทูููุ",
        "options": ["ุตูุงูู ุตุญูุญ", "ุตูุงูู ุจุงุทู", "ูุฌุจ ุนููู ุงููุถุงุก", "ุนููู ููุงุฑุฉ"],
        "answer": "ุตูุงูู ุจุงุทู"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุณุจุจ ุงูุฌููู ุงูุทูููุ",
        "options": ["ุตูุงูู ุตุญูุญ", "ุตูุงูู ุจุงุทู", "ูุฌุจ ุนููู ุงููุถุงุก", "ุนููู ููุงุฑุฉ"],
        "answer": "ุตูุงูู ุจุงุทู"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุณุจุจ ุงูุณูุฑุ",
        "options": ["ุตูุงูู ุตุญูุญ", "ุตูุงูู ุจุงุทู", "ูุฌุจ ุนููู ุงููุถุงุก", "ุนููู ููุงุฑุฉ"],
        "answer": "ุตูุงูู ุจุงุทู"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุณุจุจ ุงูุฅุบูุงุก ุงูุฌุฒุฆูุ",
        "options": ["ุตูุงูู ุตุญูุญ", "ุตูุงูู ุจุงุทู", "ูุฌุจ ุนููู ุงููุถุงุก", "ุนููู ููุงุฑุฉ"],
        "answer": "ุตูุงูู ุตุญูุญ"
    },
    {
        "question": "ูุง ูู ุญูู ูู ุฃูุทุฑ ูู ุฑูุถุงู ุจุณุจุจ ุงูุฌููู ุงูุฌุฒุฆูุ",
        "options": ["ุตูุงูู ุตุญูุญ", "ุตูุงูู ุจุงุทู", "ูุฌุจ ุนููู ุงููุถุงุก", "ุนููู ููุงุฑุฉ"],
        "answer": "ุตูุงูู ุตุญูุญ"
    }, 


]

# ุญูุธ ุชูุฏู ุงููุณุชุฎุฏููู ูู ุงูุงุฎุชุจุงุฑ
user_progress = {}

# ุฏุงูุฉ ูุฅูุดุงุก ูุงุฆูุฉ ุงูุฃุฒุฑุงุฑ ุงูุฑุฆูุณูุฉ
def create_main_menu():
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True, one_time_keyboard=True)
    btn_questions = types.KeyboardButton("ุงูุฃุณุฆูุฉ ๐")
    btn_other = types.KeyboardButton("ุฐฺชุฑ ูุฒุงุฏ โจ")
    markup.add(btn_questions, btn_other)
    return markup

# ุฏุงูุฉ ูุฅูุดุงุก ุฒุฑ "ุงุถุบุท ููุง ููููุงุตูุฉ"
def create_continue_button():
    markup = types.InlineKeyboardMarkup()
    btn_continue = types.InlineKeyboardButton("โก๏ธ ุงูุชุงูู", callback_data="next_question")
    markup.add(btn_continue)
    return markup

# ุฏุงูุฉ ูุฅูุดุงุก ุฒุฑ "ุฃุนุฏ ุงููุญุงููุฉ"
def create_retry_button():
    markup = types.InlineKeyboardMarkup()
    btn_retry = types.InlineKeyboardButton("๐ ุฃุนุฏ ุงููุญุงููุฉ", callback_data="retry_question")
    markup.add(btn_retry)
    return markup

# ุฏุงูุฉ ุจุฏุก ุงูุงุฎุชุจุงุฑ ุนูุฏ ุฅุฑุณุงู /start
@bot.message_handler(commands=['start'])
def start_quiz(message):
    try:
        user_id = message.from_user.id
        user_progress[user_id] = {"score": 0, "current_question": 0, "attempts": 0}

        bot.send_message(message.chat.id, "ูุฑุญุจูุง ุจู ูู ุงูุงุฎุชุจุงุฑ! ุงุฎุชุฑ ูู ุงููุงุฆูุฉ:", reply_markup=create_main_menu())
    except Exception as e:
        logger.error(f"ุญุฏุซ ุฎุทุฃ ูู start_quiz: {e}")
        bot.send_message(message.chat.id, "ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุจุฏุก ุงูุงุฎุชุจุงุฑ. ุญุงูู ูุฑุฉ ุฃุฎุฑู ูุงุญููุง.")

# ุฏุงูุฉ ูุนุฑุถ ุงูุฃุณุฆูุฉ ุนูุฏ ุงูุถุบุท ุนูู "ุงูุฃุณุฆูุฉ ๐"
@bot.message_handler(func=lambda message: message.text == "ุงูุฃุณุฆูุฉ ๐")
def show_questions(message):
    try:
        user_id = message.from_user.id
        if user_id not in user_progress:
            bot.send_message(message.chat.id, "ูุฑุฌู ุจุฏุก ุงูุงุฎุชุจุงุฑ ุจุฅุฑุณุงู /start.")
            return

        user_progress[user_id]["current_question"] = 0
        send_question(message.chat.id, user_id)
    except Exception as e:
        logger.error(f"ุญุฏุซ ุฎุทุฃ ูู show_questions: {e}")
        bot.send_message(message.chat.id, "ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุนุฑุถ ุงูุฃุณุฆูุฉ.")

# ุฏุงูุฉ ูุฅุฑุณุงู ุงูุณุคุงู ุงูุญุงูู
def send_question(chat_id, user_id):
    try:
        user_data = user_progress.get(user_id)
        if not user_data:
            bot.send_message(chat_id, "ูุฑุฌู ุจุฏุก ุงูุงุฎุชุจุงุฑ ุจุฅุฑุณุงู /start.")
            return

        current_question_index = user_data["current_question"]
        if current_question_index < len(QUESTIONS):
            question_data = QUESTIONS[current_question_index]
            markup = types.InlineKeyboardMarkup()

            for option in question_data["options"]:
                button = types.InlineKeyboardButton(option, callback_data=f"answer_{option}")
                markup.add(button)

            bot.send_message(chat_id, f"โ ุงูุณุคุงู {current_question_index + 1}: {question_data['question']}", reply_markup=markup)
        else:
            final_score = user_data["score"]
            total_questions = len(QUESTIONS)
            bot.send_message(chat_id, f"๐ ููุฏ ุฃูููุช ุงูุงุฎุชุจุงุฑ! ูุชูุฌุชู: {final_score}/{total_questions}")
    except Exception as e:
        logger.error(f"ุญุฏุซ ุฎุทุฃ ูู send_question: {e}")
        bot.send_message(chat_id, "ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅุฑุณุงู ุงูุณุคุงู.")

# ุฏุงูุฉ ุงูุชุญูู ูู ุงูุฅุฌุงุจุฉ ุนูุฏ ุงุฎุชูุงุฑ ุฎูุงุฑ
@bot.callback_query_handler(func=lambda call: call.data.startswith("answer_"))
def check_answer(call):
    try:
        user_id = call.from_user.id
        user_data = user_progress.get(user_id)

        if not user_data:
            bot.answer_callback_query(call.id, "ูุฑุฌู ุจุฏุก ุงูุงุฎุชุจุงุฑ ุจุฅุฑุณุงู /start.")
            return

        chosen_answer = call.data.split("_")[1]
        current_question_index = user_data["current_question"]
        correct_answer = QUESTIONS[current_question_index]["answer"]

        bot.delete_message(call.message.chat.id, call.message.message_id)

        if chosen_answer == correct_answer:
            bot.send_message(call.message.chat.id, "โ ุฅุฌุงุจุฉ ุตุญูุญุฉ! ููููู ุงููุชุงุจุนุฉ.", reply_markup=create_continue_button())
            user_data["score"] += 1
            user_data["current_question"] += 1
            user_data["attempts"] = 0
        else:
            user_data["attempts"] += 1
            if user_data["attempts"] >= 3:
                bot.send_message(call.message.chat.id, f"๐ ุงุณุชููุฐุช ุฌููุน ูุญุงููุงุชู.\nโ ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ: {correct_answer}", reply_markup=create_continue_button())
                user_data["current_question"] += 1
                user_data["attempts"] = 0
            else:
                bot.send_message(call.message.chat.id, "โ ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ! ุญุงูู ูุฌุฏุฏูุง.", reply_markup=create_retry_button())
    except Exception as e:
        logger.error(f"ุญุฏุซ ุฎุทุฃ ูู check_answer: {e}")
        bot.answer_callback_query(call.id, "ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุชุญูู ูู ุงูุฅุฌุงุจุฉ.")

# ุฏุงูุฉ ุงูุงูุชูุงู ุฅูู ุงูุณุคุงู ุงูุชุงูู
@bot.callback_query_handler(func=lambda call: call.data == "next_question")
def next_question(call):
    try:
        user_id = call.from_user.id
        user_data = user_progress.get(user_id)

        if not user_data:
            bot.send_message(call.message.chat.id, "ูุฑุฌู ุจุฏุก ุงูุงุฎุชุจุงุฑ ุจุฅุฑุณุงู /start.")
            return

        bot.delete_message(call.message.chat.id, call.message.message_id)
        send_question(call.message.chat.id, user_id)
    except Exception as e:
        logger.error(f"ุญุฏุซ ุฎุทุฃ ูู next_question: {e}")
        bot.send_message(call.message.chat.id, "ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุงูุชูุงู ููุณุคุงู ุงูุชุงูู.")

# ุฏุงูุฉ ุฅุนุงุฏุฉ ุงููุญุงููุฉ
@bot.callback_query_handler(func=lambda call: call.data == "retry_question")
def retry_question(call):
    try:
        user_id = call.from_user.id
        bot.delete_message(call.message.chat.id, call.message.message_id)
        send_question(call.message.chat.id, user_id)
    except Exception as e:
        logger.error(f"ุญุฏุซ ุฎุทุฃ ูู retry_question: {e}")
        bot.send_message(call.message.chat.id, "ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅุนุงุฏุฉ ุงููุญุงููุฉ.")

# ุชุดุบูู ุงูุจูุช
if __name__ == "__main__":
    keep_alive()  # ุชุดุบูู Flask ููุญูุงุธ ุนูู ุงูุชุดุบูู
    bot.ppolling(none_stop=True) 
